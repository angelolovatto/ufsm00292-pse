stateDiagram-v2
    direction LR
    [*] --> WAIT_STX
    WAIT_STX --> READ_LEN: byte==STX
    READ_LEN --> WAIT_STX: LEN==0 (error)
    READ_LEN --> READ_DATA: LEN>0
    READ_DATA --> READ_CHK: idx==LEN
    READ_CHK --> WAIT_ETX
    WAIT_ETX --> DELIVER: byte==ETX && checksum OK
    WAIT_ETX --> ERROR: byte!=ETX || checksum NOK
    ERROR --> WAIT_STX
    DELIVER --> WAIT_STX
